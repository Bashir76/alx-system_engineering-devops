#!/usr/bin/env bash
# This script installs and configures Nginx on an Ubuntu machine

# Update package list and install Nginx
sudo apt-get update
sudo apt-get install -y nginx

# Configure Nginx to listen on port 80
sudo sed -i 's/80 default_server/80 default_server;/g' /etc/nginx/sites-available/default

# Restart Nginx without using systemctl
sudo kill -HUP $(cat /var/run/nginx.pid)

# Check if Nginx is running
if pgrep -x "nginx" >/dev/null
then
	    echo "Nginx is running."
    else
	        echo "Error: Nginx is not running."
		    exit 1
fi

# Create index.html with Hello World!
echo "Hello World!" | sudo tee /var/www/html/index.html > /dev/null

# Test Nginx with curl
response=$(curl -s http://127.0.0.1)
if [ "$response" == "Hello World!" ]; then
	    echo "Nginx is configured successfully."
    else
	        echo "Error: Nginx configuration failed."
fi

